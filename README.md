# **Задание**

Приходит директор и говорит: "Чтобы компания начала расти, нужно еще больше сотрудников в IT отдел"

Найм происход в 2 этапа: 
1. участвуют только рекрутеры, задача рекрутера - находить кандидатов и выдавать им тестовые задания.
2. участвуют разработчики, задача разработчиков - проверять тестовые задания кандидатов.

Условия:
1. Для ускорения найма кандидаты передаются самым эффективным сотрудникам.
2. Максимальное количество кандидатов для разработчика - 3000.

Произошел сбой в CRM и часть кандидатов не привязывались за рекрутерами и не все кандидаты были переданы разработчикам.

Нужно исправить даную проблему и составить CSV файлы-отчеты с верными данными о кандидатах.

# **Решение**

1. Импорты, создание CSV файлов для отчетов, конфиг для подключения к БД, создание подключения к БД, деструктуризация типов для получения данных из БД и создания отчетов.

2. Подключение к БД и первый запрос, который возвращает список всех Рекрутеров, отсортированных по эффективности в порядке убывания, далее всех рекрутеров добавляем в массив и создаем строку формата «(x, x, …, x)» для дальнейших запросов.

3. Получаем список всех кандидатов с датой теста, равно 0(т.е. тест не написан, следовательно, они еще на первом этапе), также сразу получим список всех уже привязанных кандидатов к рекрутерам. Напишем цикл для добавления кандидата к рекрутеру, внутри этого цикла напишем еще один, который будет проверять, есть ли у кандидата рекрутер. К рекрутерам добавляем по очереди, где первый – самый эффективный, последний – самый неэффективный. Также создадим словарь Map, в котором будут данные формата <*ID рекрутера*, *массив новых кандидатов*>. Затем в массив “candToPush” добавляем строки данных формата [*ID кандидата*, *ID города*, *ID рекрутера*, *текущее время*] для добавления новых записей в таблицу `candidate_to_employee_assign`.  Затем добавляем все данные в массиве “candToPush” в таблицу `candidate_to_employee_assign`.

4. Получаем всех кандидатов с датой теста после 03.06.2024, проходимся циклом по всем кандидатам с рекрутером, внутри него проходимся по кандидатам с тестом. Если есть совпадение, значит такую запись нужно удалить, так как  на этом этапе к кандидату уже должен быть прикреплен разработчик. Увеличиваем счетчик кандидатов, у которых есть дата теста и они закреплены за рекрутером и удаляем эти записи из БД. Также добавляем в массив «candidateToEmployees» всех кандидатов с тестом. После этого цикла длина массива «candidateToEmployees» это ответ на первый вопрос: «Сколько Кандидатов сделали тестовое задание и при этом были закреплены за рекрутерами до сбоя в CRM?». Затем создаем словарь Map с форматом <*ID рекрутера*, *массив кандидатов, которых довел до теста(т.е. кандидаты из массива «candidateToEmployees»)*>. Затем проходимся по всем рекрутерам и заносим данные для отчета. Сохраняем первый CSV файл.

5. Получим всех разработчиков, отсортированных по эффективности в порядке убывания. Создадим словарь Map<*ID разработчика*, *кол-во новых кандидатов*>.  Далее проходимся циклом по всем кандидатам с тестом, которые не закреплены за разработчиком и добавляем к разработчикам, сначала полностью забиваем разработчика с максимальной эффективностью до 3000, затем разработчика с эффективностью поменьше и т.д. В момент закрепления кандидат за разработчиком добавляем эту запись в БД. Затем из полученных данных формируем отчет CSV и ответ на вопрос «Какому «Разработчику» после вашего распределения больше всего досталось новых Кандидатов и их тестовых заданий? И сколько ему досталось?» Сохраняем CSV и закрываем connection.